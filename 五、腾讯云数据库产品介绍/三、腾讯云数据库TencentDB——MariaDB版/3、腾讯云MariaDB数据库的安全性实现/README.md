# 腾讯云MariaDB数据库的安全性实现
如果您在腾讯云中使用到了云数据库、云服务器、私有网络等服务，这些服务由不同的人管理，但都共享您的云账号密钥，将存在以下问题：
* 您的密钥由多人共享，泄密风险高。
* 您无法限制他人的访问权限，易产生误操作造成安全风险。

这个时候，访问管理 CAM 应运而生。

接入 CAM 后，可通过子账号实现不同的人管理不同的服务，以避免以上的问题。默认情况下，子账号没有使用云数据库实例以及云数据库相关资源的权限。因此，我们就需要创建策略来允许子账号使用他们所需要的资源或者权限。

策略是定义和描述一条或多条权限的语法规范，策略通过授权一个用户或者一组用户来允许或拒绝使用指定资源。

CAM 策略必须授权使用一个或多个云数据库操作或者必须拒绝使用一个或多个云数据库操作。同时还必须指定可以用于操作的资源（可以是全部资源，某些操作也可以是部分资源），策略还可以包含操作资源所设置的条件。

## 1、配置云数据库安全组
安全组是一种有状态的包含过滤功能的虚拟防火墙，用于设置单台或多台云数据库的网络访问控制，是腾讯云提供的重要的网络安全隔离手段。安全组是一个逻辑上的分组，您可以将同一地域内具有相同网络安全隔离需求的私有网络云数据库实例加到同一个安全组内 ，暂不支持基础网络云数据库。云数据库与云服务器等共享安全组列表，安全组内基于规则匹配，云数据库不支持的规则自动不生效。

**注意**：云数据库安全组目前仅支持私有网络 VPC 内网访问，暂不支持对基础网络的网络控制和外网访问的网络控制。

## 2、管理云数据库安全组

您可以在MariaDB 控制台 页面的【实例列表】-【数据安全性】-【安全组】中管理云数据库。
 
注意云数据库共享云服务器的安全组规则，您可以根据实际情况在【云数据库安全组管理页面】匹配或调整优先级。云数据库安全组管理页面不支持创建、删除安全组规则本身。

## 3、安全组策略
安全组策略分为允许和拒绝流量。您可以通过安全组策略对实例的入流量进行安全过滤，实例可以是：私有网络云数据库实例 。

## 4、云数据库安全组默认策略

当前购买云数据库且为 VPC 网络时，可以无需关联任何安全组；此时默认策略为“放通全部 IP 和端口”。

## 5、安全组模板

安全组支持自定义创建和模板创建，通过配置安全组规则对出入云服务器的数据包进行控制。目前系统提供三个模板：

1.Linux 放通 22 端口：仅暴露 SSH 登录的 TCP 22 端口到公网，内网端口全通，此模板对云数据库不生效。

2.Windows 放通 3389 端口：仅暴露 MSTSC 登录的 TCP 3389 端口到公网，内网端口全通，此模板对云数据库不生效。

3.放通全部端口：允许全部 IP 访问云数据库。有一定安全风险，请谨慎操作。

## 6、安全组规则
安全组规则可控制允许到达与安全组相关联实例的入站流量，以及允许离开实例的出站流量（从上到下依次筛选规则）。默认情况下，新建安全组将 All Drop （拒绝）所有流量。您可以随时修改安全组的规则，新规则保存后立即生效。

对于安全组的每条规则，有以下几项内容：

1.协议端口：云数据库协议端口仅支持 ALL，由于 TencentDB 只提供固定端口访问，所以无需指定端口，若指定端口则该条规则对云数据库不生效。

2.授权类型：地址段（CIDR/IP）访问；

3.来源（入站规则）或目标（出站规则），请指定以下选项之一：
* 用 CIDR 表示法，指定的单个 IP 地址。
* 用 CIDR 表示法，指定的 IP 地址范围（例如，203.0.113.0/24）。

4.策略：允许或拒绝。

## 7、安全组优先级
您在实例控制台中配置的安全组优先级，数字越小优先级越高。实例绑定多个安全组时，优先级将作为判断该实例总的安全规则的评估依据。
另外，如果实例绑定的多个安全组的最后一条策略是【ALL Traffic 拒绝】，那么除了优先级最低的安全组，其它安全组的最后一条策略【ALL Traffic 拒绝】将失效。

## 8、安全组的限制

1.安全组适用于私有网络网络环境下的云数据库实例。

2.每个用户在每个地域每个项目下最多可设置 50 个安全组。

3.一个安全组入站方向、出站方向的访问策略，各最多可设定 100 条。由于云数据库没有主动出站流量，因此出站规则对云数据库不生效。

4.一个云数据库可以加入多个安全组，一个安全组可同时关联多个云数据库，数量无限制。

**注意**：安全组内实例个数虽无限制，但不宜过多。

<table>
    <tr>
        <th>功能描述</th>
        <th>数量</th>
    </tr>
    <tr>
        <td>安全组</td>
        <td>50 个/地域</td>
    </tr>
    <tr>
        <td>访问策略</td>
        <td>100 条/入站方向，100 条/出站方向</td>
    </tr>
    <tr>
        <td>实例关联安全组个数</td>
        <td>无限制</td>
    </tr>
    <tr>
        <td>安全组内实例的个数</td>
        <td>无限制</td>
    </tr>
</table>

## 9、创建、管理和删除安全组规则
云数据库共享云服务器的安全组规则，您可以根据实际情况在【云数据库安全组管理页面】匹配或调整优先级。创建、管理和删除安全组规则请至安全组管理页面。









