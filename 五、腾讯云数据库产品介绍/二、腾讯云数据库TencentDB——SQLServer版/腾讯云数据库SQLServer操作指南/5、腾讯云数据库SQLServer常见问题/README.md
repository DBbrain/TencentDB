# 腾讯云数据库SQLServer常见问题
## 1、功能相关问题
1.云数据库 SQL Server 产品架构是怎样的？

云数据库 SQL Server 由一主一镜像的 SQL Server 数据库组成，跨机架部署，每个库对应一组监控 Agent，通过心跳对数据库进行实时监控。独立部署的两组决策，调度集群和配置集群组成，作为集群的管理调度中心，主要管理数据库节点组、接入网关集群、HDFS 的正常运行。Hadoop 分布式文件系统（HDFS）提供数据灾备服务，提供冷备数据。接入网关集群，对外提供唯一的 IP，如果数据节点发送切换，IP 不会改变。

2.云数据库 SQL Server 如何创建实例并连接到数据库？

您可以通过 SQL Server 的管理控制台页面来完成管理数据库相关工作。

3.云数据库 SQL Server 实例帐号如何管理？

云数据库 SQL Server 禁止通过 Microsoft SQL Server Management 执行创建、删除数据库、创建、删除或修改账号操作，支持在SQL Server 控制台 > 实例详情页 > 【帐号管理】，创建、删除帐号或修改帐号权限。

目前仅支持用户使用“读写”、“只读”权限。

4. 云数据库 SQL Server 实例如何监控？

云数据库 SQL Server 支持 SQL Server 常见的25种参数，您可以通过配置 SSMS 的计数器，额外统计其他参数。

目前支持通过云监控对以下监控指标进行告警，您可以在【云监控】>【告警配置】>【告警策略】里面配置告警。
<ul>
    <li>CPU 利用率</li>
    <li>连接数</li>
    <li>输入流量</li>
    <li>输出流量</li>
    <li>IOPS</li>
    <li>存储空间</li>
</ul>
5.云数据库 SQL Server 实例如何回档？

云数据库 SQL Server 的全量备份和日志备份保存7天，因此可以回档到7天内的任意时刻。

6.云数据库 SQL Server 实例如何备份？

云数据库 SQL Server 控制台中可以通过下载的备份文件将数据库恢复到其他实例（如自建实例）上。

7.云数据库 SQL Server 如何迁移数据？

云数据库 SQL Server 支持CVM自建 SQL Server 迁移数据和其他云厂商或自建 SQL Server 迁移。

8.云数据库 SQL Server 升级流程是怎样的？

升级操作指将现有云数据库 SQL Server 实例的规格升级到更高规格。

(1)	在SQL Server 控制台中选择选择相应的实例，在【操作】列，单击【升级】。

(2)	在弹出的升级页，根据需要选择目标规格，并支付费用，成功后系统将自动升级实例规格。

(3)	升级费用 =（目标规格单价 - 原规格单价）x 剩余到期时间

## 2、存储空间

1.云数据库 SQL Server 对库的数量是否有限制？

云数据库 SQL Server 对数据库个数的创建没有限制，从性能考虑，建议单个 SQL Server 实例下创建的数据库个数不超过70个。

2.SQL Server 到期会怎样？

(1)	云数据库资源到期前七天，系统会通过邮件、站内信及短信的方式给用户发送续费提醒通知。

(2)	到期后七天内，云数据库还可以继续使用，需要尽快续费，系统将发送云数据库到期提醒。

(3)	到期超过七天的云数据库资源将被系统回收，数据将会被清除，不可恢复。

3.创建 SQL Server 数据库后，还没有写入数据或写入极少量数据，为什么存储空间监控显示是已经占用500MB数据？

腾讯云每个 SQL Server 数据库，会自动分配500MB的初始化空间，数据写入时，会优先写入到初始化空间中。因此您没有写入数据或写入极少量数据，存储监控也会显示500MB。

4.SQL Server 写入数据删掉后，存储空间监控仍显示占用了相当数量的存储空间，空间不会释放吗？

SQL Server 删除数据后，已经扩展的数据文件不会收缩，文件内部空闲的空间可以支撑后续插入、更新等操作。

例如您申请50GB的实例，某一个数据库写入50GB数据后再全部删除，这时候存储空间监控您已经使用了50GB，但您仍可以继续写入大量文件。

5.通过 Microsoft SQL Server Management 管理数据库，系统提示 “Login failed. The login is from an untrusted domain and cannot be used with Windows authentication”，是为什么？

请将身份认证方式改为“SQL Server 身份验证”。

6.SQL Server 使用 SSH 端口映射外网连接管理实例？

考虑到数据的安全，目前云数据库 SQL Server 尚未开放实例的外网 IP，有需求的用户可以利用 SSH2 的端口映射在外网连接实例，并对其进行配置和管理。











